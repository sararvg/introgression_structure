# Usage

The script "code_structure.py" can be used to simulate introgression from one population into one another and analyze the resulting populations with Structure (Pritchard et al., 2000). From the programme output the script will extract ancestral values as q values relative to population 1 and the realtive confidence intervals (CI).

Before using it, you need to:
- set the main path (mpath) in the script
- inside the main path, create folders for analysis: 
    1. populations for the input populations 
    2. input for the subsamples 
    3. input_Structure for the input file to be analysed in Structure 
    4. output_Structure for the output file generated by Structure 
    5. real_qvalues for the q values calculated during the simulations 
    6. results for q values and confidence intervals obtained from Structure
- set the path where Structure is installed (filepath)
- the input files obtained with Easypop (Balloux, 2001) in .dat format have to be stored in the /populations folder
- change the different parameters for the analysis (m, Ngen, Nind, Nmarker, N1, N2, fst, allele_number, num_individuals) 

The real q values will be stored in the /real_qvalue folder, while the Structure results in the /results folder

The script "code_structure_reference.py" works as "code_structure.py", but it is modified to include a proprtion of individuals from the ancestral population in the input file to be analysed in Structure. 

The script "code_structure_reference_popinfo.py" generates input files for Structure, with a proportion of pure individuals from population A. The files have two additional columns with POPDATA and POPFLAG information, to be used with the USEPOPINFO option in Structure. 

# Reference 

Pritchard, J. K., Stephens, M., & Donnelly, P. (2000). Inference of population structure using multilocus genotype data. Genetics, 155(2), 945–959. https://doi.org/10.1111/j.1471-8286.2007.01758.x

Balloux, F. (2001). EASYPOP (Version 1.7): A Computer Program for Population Genetics Simulations. Journal of Heredity, 92(3), 301–302. https://doi.org/10.1093/jhered/92.3.301
